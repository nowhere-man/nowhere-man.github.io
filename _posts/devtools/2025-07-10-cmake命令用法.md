---
layout: post
title: cmake 1：命令用法
slug: cmake-cli-usage
categories: [开发工具]
tags: [CMAKE]
---

## cmake构建流程
cmake工作的三个阶段
+ 配置
+ 生成
+ 构建


![](/assets/images/cmake1.png)

## 生成项目构建系统
基本用法：
+ -S：指定源码树的路径
+ -B：指定生成的构建系统的目录
+ -G：执行生成器

```bash
cmake -S <path-to-source> -B <path-to-build>
```

列出缓存变量:

```bash
cmake -L[A][H] <path-to-source>
```

现有缓存变量的初始化和修改:

```bash
cmake -D <var>[:<type>]=<value> <path-to-source>
```

调试和跟踪:

```bash
# 获取关于变量、命令、宏和其他设置的一般信息
cmake --system-information [output-filename]

# 设置日志级别 (默认是STATUS)
cmake --log-level=<ERROR|WARNING|NOTICE|STATUS|VERBOSE|DEBUG|TRACE>

# 跟踪模式：打印每个命令的文件名和调用的确切行号及其参数
cmake --trace
```

## 构建项目
基本用法：

```bash
# <dir>为-B参数传递的路径
cmake --build <dir> --parallel [<number-of-jobs>]

# 删除构建目录中的所有构件
cmake --build <dir> -t clean

# 先清理，再构建
cmake --build <dir> --clean-first
```

## 安装项目

```bash
cmake --install <dest-dir>

# 为安装目录指定默认权限，使用以下选项，格式为: u=rwx,g=rx,o=rx
cmake --install <dest-dir> --default-directory-permissions <permissions>
```

调试和跟踪:

```bash
cmake --build <dest-dir> --verbose
```

## 运行脚本

```bash
cmake -P <cmake-script-file>
```

## 可视化依赖

```bash
cmake --graphviz=<file-path> <cmake-dir>
```
